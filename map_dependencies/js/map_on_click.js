var countriesLayer=L.geoJson(countries),markerSpain=L.marker([40,-4]),markerUK=L.marker([52,-1]),markerFrance=L.marker([47,2]),SpainPopup=L.popup({className:"infopop",maxHeight:150}).setContent("<div><h2>Plain text popup</h2><p>Curabitur in risus et felis gravida tristique. Maecenas accumsan nunc sapien, eget dignissim mauris laoreet in. Nulla sollicitudin, tortor aliquam vestibulum mattis, neque sem blandit enim, at hendrerit risus mi nec augue. Cras tincidunt tincidunt dictum. Vivamus id condimentum magna.</p></div>"),FrancePopup=L.popup({className:"infopop",minWidth:250}).setContent('<h2>Image popup</h2><a title="Jean-Pierre HouÃ«l [Public domain or Public domain], via Wikimedia Commons" href="https://commons.wikimedia.org/wiki/File:Prise_de_la_Bastille.jpg"><img width="100%" alt="Prise de la Bastille" src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4e/Prise_de_la_Bastille.jpg/512px-Prise_de_la_Bastille.jpg"></a>'),UKPopup=L.popup({className:"infopop",maxWidth:400,maxHeight:400}).setContent('<h2>Video popup</h2><iframe width="320" height="180" src="https://www.youtube.com/embed/-p3bGPebr_E" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>');markerSpain.bindPopup(SpainPopup),markerFrance.bindPopup(FrancePopup),markerUK.bindPopup(UKPopup);var FranceCircle=L.circleMarker([47,2.5],{color:"red",fillColor:"#f03",fillOpacity:.5,radius:25}),SpainCircle=L.circleMarker([40.5,-4],{color:"red",fillColor:"#f03",fillOpacity:.5,radius:21}),GermanyCircle=L.circleMarker([51,9.5],{color:"red",fillColor:"#f03",fillOpacity:.5,radius:20}),countryMarkers=L.layerGroup([markerSpain,markerUK,markerFrance]),countryShapes=L.layerGroup([FranceCircle,SpainCircle,GermanyCircle]),map=L.map("map",{center:[50,9],zoomControl:!0,zoom:4.2,attributionControl:!0,dragging:!0,doubleClickZoom:!0,fadeAnimation:!0,keyboard:!0,trackResize:!0,closePopupOnClick:!0,zoomAnimation:!0,keyboardPanDelta:100,layers:[countriesLayer]}),baseLayer={Countries:countriesLayer},overlays={Markers:countryMarkers,Shapes:countryShapes},layersControl=L.control.layers(baseLayer,overlays,{position:"bottomleft"}).addTo(map);function colourCountries(e){var r=e.properties.countryColor;return r?{fillColor:r,fillOpacity:1,color:"#ffffff",opacity:1,weight:.5}:{fillColor:"#DAE3E8",fillOpacity:1,color:"#ffffff",opacity:1,weight:1}}function filterCountries(e){var r=e.properties.filterColor;return r?{fillColor:r,fillOpacity:1,color:"#ffffff",opacity:1,weight:.7}:{fillColor:"#DAE3E8",fillOpacity:1,color:"#ffffff",opacity:1,weight:1}}function heatMap(e){var r=e.properties.heatColor;return r?{fillColor:r,fillOpacity:1,color:"#ffffff",opacity:1,weight:.7}:{fillColor:"#DAE3E8",fillOpacity:1,color:"#ffffff",opacity:1,weight:1}}countriesLayer=L.geoJson(countries,{style:colourCountries}).addTo(map);var legend=L.control({position:"topright"});legend.onAdd=function(e){var r=L.DomUtil.create("div","mapLegend");return r.innerHTML="<h3>UK-EU bilateral countries relations</h3><p>This map demonstrates the UK's bilateral relationship with the 27 other EU Member States.</p><b><p>Click on each country to reveal relevant information</p></b>",r},legend.addTo(map);var centerMap=L.control({position:"topleft"});centerMap.onAdd=function(e){this._div=L.DomUtil.create("div","centerControl");return this._div.innerHTML="<div class='crossClass'><img src='map_dependencies/leaflet/images/center.png' style='width:32px;height:32px;border:2px solid #bebebe;' title='Center Map'></img></div>",this._div},centerMap.addTo(map),countriesLayer.eachLayer(function(e,r){"United Kingdom of Great Britain and Northern Ireland"!==e.feature.properties.formal_en&&e.feature.properties.showPopup?e.bindPopup("<h5>"+e.feature.properties.name_sort+"</h5><p><b>EU member since: </b>"+e.feature.properties.member_since+"<br><b>Population (2016): </b>"+e.feature.properties.population+" million<br><b>Net Salary (2017): </b>"+e.feature.properties.NET_Salary+"<br><b>Surface: </b>"+e.feature.properties.surface+' km<sup>2</sup></p><a class="moreLink">Read More</a>'):"United Kingdom of Great Britain and Northern Ireland"===e.feature.properties.formal_en&&e.bindPopup("<h5>"+e.feature.properties.name_sort+"</h5><p><b>EU member since: </b>"+e.feature.properties.member_since+"<br><b>Population (2016): </b>"+e.feature.properties.population+" million<br><b>Net Salary (2017): </b>"+e.feature.properties.NET_Salary+"<br><b>Surface: </b>"+e.feature.properties.surface+" km<sup>2</sup></p>"),e.on("popupopen",function(){$(".moreLink").click(function(e){e.preventDefault();var r=$(this).parent().children().first().text();r=r.replace(/\s+/g,"");var o=$("#panelcollapse"+r),i=$(o).prev().offset().top;$("html, body").animate({scrollTop:i-5},700),$(o).collapse("show"),$(o).parent().fadeOut(300).fadeIn(300).fadeOut(300).fadeIn(300).css("border","1px solid #000")})})}),$(document).ready(function(){$(".backToTop").click(function(e){e.preventDefault(),$(this).closest(".panel.panel-default").css("border","1px solid #ddd"),$("html, body").animate({scrollTop:0},700)});var e=$('span:contains("Markers")').prev();$(e).click(function(){$(this).prop("checked")&&alert("Click on the markers to reveal further information")}),$(".panel.panel-default").click(function(){$(this).find(".panel-collapse").collapse("show")&&($(this).find(".panel-collapse").collapse("hide"),$(this).closest(".panel.panel-default").css("border","1px solid #ddd")),$(this).find(".panel-collapse").collapse("show")}),$('button:contains("Expand All Panels")').click(function(e){e.preventDefault(),$(".panel-collapse").collapse("show")}),$('button:contains("Collapse All Panels")').click(function(e){e.preventDefault(),$(".panel-collapse").collapse("hide")}),$('button:contains("Remove Filter")').click(function(e){e.preventDefault(),countriesLayer.setStyle(colourCountries)}),$('button:contains("Filter Countries")').click(function(e){e.preventDefault(),countriesLayer.setStyle(filterCountries)}),$('button:contains("Heat Map")').click(function(e){e.preventDefault(),countriesLayer.setStyle(heatMap)}),$(".centerControl").click(function(){map.setView(new L.LatLng(50,9),4.2)})});